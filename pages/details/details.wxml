<view class="container">
  <!-- 孩子基本信息 -->
  <view class="header">
    <image class="avatar" src="{{child.avatar || (child.gender == '男' ? '/assets/icons/boy.png' : '/assets/icons/girl.png')}}" />
    <view class="info">
      <text class="name">{{child.name}}</text>
      <text class="details">性别：{{child.gender}} | 年龄：{{age}} 岁</text>
      <text class="birth">出生日期：{{child.birth_time}}</text>
    </view>
  </view>
  <!-- <text class="name">{{child.name}}身高生长曲线</text>

  <view class="charts">

    <canvas canvas-id="NwbCBhcNOuQXlMCxznViehwgujHjDjVo-height" id="NwbCBhcNOuQXlMCxznViehwgujHjDjVo-height" class="charts" bindtouchstart="touchstart" bindtouchmove="touchmove" bindtouchend="touchend" />
  </view>
  <text class="name">{{child.name}}体重生长曲线</text>

  <view class="charts">

    <canvas canvas-id="NwbCBhcNOuQXlMCxznViehwgujHjDjVo-weight" id="NwbCBhcNOuQXlMCxznViehwgujHjDjVo-weight" class="charts" bindtouchstart="touchstart" bindtouchmove="touchmove" bindtouchend="touchend" />
  </view> -->



  <!-- 添加成长记录按钮 -->
  <button wx:if="{{userType=='parent'}}" class="add-btn" bindtap="onAdd">新增成长信息</button>

  <!-- 成长记录列表 -->
  <view class="growth-list">
    <block wx:for="{{growthRecords}}" wx:key="id">
      <view class="growth-card">
        <view class="growth-row">
          <!-- 第一列：身高、体重、BMI -->
          <view class="column">
            <text>身高：{{item.height}} cm</text>
            <text>体重：{{item.weight}} kg</text>
            <text>BMI：{{item.bmi}}</text>
          </view>

          <!-- 第二列：骨龄、检测日期 -->
          <view class="column">
            <text>骨龄：{{item.boneAge}} 岁</text>
            <text>检测日期：{{item.testDate}}</text>
          </view>
          
          <!-- 底部添加创建时间 -->
          <view class="create-time">
            <text>记录时间：{{item.createTime}}</text>
          </view>
          <!-- 第三列：编辑和删除按钮 -->
          <view wx:if="{{userType=='parent'}}" class="icon-group">
            <image class="icon-btn" src="/assets/icons/edit.png" data-id="{{item.id}}" bindtap="onEdit" />
            <image class="icon-btn" src="/assets/icons/delete.png" data-id="{{item.id}}" bindtap="onDelete" />
          </view>
        </view>


      </view>
    </block>
  </view>



  <!-- 弹出框 -->
  <view wx:if="{{showModal}}" class="modal">
    <view class="modal-content">
      <text class="modal-title">发育预测</text>
      <scroll-view class="form-scroll" scroll-y="true">
        <view class="form">
          <text>身高：</text>
          <input type="digit" value="{{form.height}}" placeholder="cm" bindinput="onInputChange" data-field="height" />
          <text>体重：</text>
          <input type="digit" value="{{form.weight}}" placeholder="kg" bindinput="onInputChange" data-field="weight" />
          <text>BMI指数：</text>
          <input type="digit" value="{{form.bmi}}" placeholder="自动计算或手动输入" bindinput="onInputChange" data-field="bmi" />
          <text>骨龄：</text>
          <input type="digit" value="{{form.boneAge}}" placeholder="岁" bindinput="onInputChange" data-field="boneAge" />
          <text>检测日期：</text>
          <picker mode="date" value="{{form.testDate}}" start="2020-01-01" end="2030-12-31" bindchange="onDateChange">
            <view class="picker-text">{{form.testDate || '请选择检测日期'}}</view>
          </picker>
        </view>
      </scroll-view>
      <view class="modal-actions">
        <button bindtap="closeModal">取消</button>
        <button bindtap="onSave" class="save-btn">保存</button>
      </view>
    </view>
  </view>
</view>